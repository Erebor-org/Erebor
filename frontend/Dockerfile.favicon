# Dockerfile pour la g√©n√©ration des favicons Erebor
FROM node:18-alpine

# Installer les d√©pendances syst√®me
RUN apk add --no-cache \
    python3 \
    make \
    g++ \
    cairo-dev \
    jpeg-dev \
    pango-dev \
    musl-dev \
    giflib-dev \
    pixman-dev \
    pangomm-dev \
    libjpeg-turbo-dev \
    freetype-dev

# D√©finir le r√©pertoire de travail
WORKDIR /app

# Copier les fichiers de configuration
COPY package*.json ./
COPY scripts/ ./scripts/

# Installer les d√©pendances
RUN npm install

# Copier le logo source
COPY src/assets/erebor_logo.png ./src/assets/

# Cr√©er le r√©pertoire public
RUN mkdir -p public

# G√©n√©rer les favicons
RUN cd scripts && npm install && npm run generate:optimized

# V√©rifier que les favicons ont √©t√© g√©n√©r√©s
RUN ls -la public/

# Afficher un message de succ√®s
RUN echo "üéâ Favicons g√©n√©r√©s avec succ√®s !"

# Commande par d√©faut
CMD ["sh", "-c", "echo 'Favicons pr√™ts !' && ls -la public/"]
